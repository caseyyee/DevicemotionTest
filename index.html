<!DOCTYPE html>
<html>
<head>
  <title></title>
</head>
<body>
<b>Devicemotion events</b>

<br/><br/>
Timestamp:
<div id="timestamp"></div>

delta:
<div id="delta"></div>

delta averaged:
<div id="delta-average"></div>

<br/><br/>
Acceleration Including Gravity:
<div id="accel"></div>

<br/><br/>
rotation rate:
<div id="rotationRate"></div>


<br/><br/>
devicemotionEvent.interval
<div id="interval"></div>

</body>
<script>
var previousTimestamp;
var timestampEl = document.getElementById('timestamp');
var deltaEl = document.getElementById('delta');
var deltaAverageEl = document.getElementById('delta-average');
var acceleration = document.getElementById('accel');
var rotation = document.getElementById('rotationRate');
var intervalContainer = document.getElementById('interval');
var isFirefoxAndroid = navigator.userAgent.indexOf('Firefox') !== -1 && navigator.userAgent.indexOf('Android') !== -1;

var deltaArray = [];
var deltaSampleSize = 100;

window.addEventListener('devicemotion', function(deviceMotion) {
  var timestamp = deviceMotion.timeStamp;
  if (isFirefoxAndroid) {
    timestamp /= 1000;
  }
  timestampEl.innerHTML = timestamp;

  var delta = timestamp - this.previousTimestamp;
  deltaEl.innerHTML = delta;

  deltaArray.push(delta)
  if (deltaArray.length > deltaSampleSize) {
    deltaArray.shift();
  };

  var deltaSum = deltaArray.reduce(function(a, b) { return a + b; });
  var deltaAverage = deltaSum/deltaArray.length;
  deltaAverageEl.innerHTML = deltaAverage;

  var accGravity = deviceMotion.accelerationIncludingGravity;
  acceleration.innerHTML = accGravity.x + '<br/>'
  						+ accGravity.y + '<br/>'
  						+ accGravity.z + '<br/>';

  var rotRate = deviceMotion.rotationRate;
  rotation.innerHTML = rotRate.alpha/100 + '<br/>'
  						+ rotRate.beta/100 + '<br/>'
  						+ rotRate.gamma/100 + '<br/>';

  intervalContainer.innerHTML = deviceMotion.interval;

  previousTimestamp = timestamp;
});
</script>
</html>

